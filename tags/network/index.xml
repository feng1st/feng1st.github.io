<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Network on 知耻而后勇，知不足而后进</title>
    <link>https://feng1st.github.io/tags/network/</link>
    <description>Recent content in Network on 知耻而后勇，知不足而后进</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>utf-8</language>
    <lastBuildDate>Thu, 08 Jun 2017 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://feng1st.github.io/tags/network/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>TCP/IP协议摘要</title>
      <link>https://feng1st.github.io/post/2017-06-08-tcp-ip/</link>
      <pubDate>Thu, 08 Jun 2017 00:00:00 +0000</pubDate>
      
      <guid>https://feng1st.github.io/post/2017-06-08-tcp-ip/</guid>
      <description>

&lt;h2 id=&#34;协议分层:37348dd643956dbb1568c00c8cc0c5b2&#34;&gt;协议分层&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;应用层 Application&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;对应OSI协议Application、Presentation、Session三层&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;常见上层协议：HTTP、FTP、SMTP、TELNET&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;传输层 Transport&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;对应OSI协议Transport层&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;协议：&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;TCP：（见下）&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;UDP：不超时重传、不错误重传、不保证顺序&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;网络层 Internet&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;对应OSI协议Network层&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;协议：&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;IP：（见下）&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;ARP：IP地址到MAC地址转换&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;DARP：（略）&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;ICMP：发生错误时，错误信息封包传给主机；IP重定向报文；路由发现报文&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;ping&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;traceroute&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;利用IP协议的TTL实现&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;利用主机不可达和端口不可达区分&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;网络接口层 Network Interface&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;对应OSI协议Data Link、Physical两层&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;附加以太网部首&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;ip协议:37348dd643956dbb1568c00c8cc0c5b2&#34;&gt;IP协议&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;附加IP部首&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;TTL，生存周期，每路由一层减1，为0时丢弃&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;实现traceroute&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;路由顺序：&lt;br /&gt;

&lt;ol&gt;
&lt;li&gt;TTL为0时丢弃&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;匹配主机&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;匹配同子网路由器&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;匹配同网号路由器&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;匹配默认路由器&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;不保证可达，需配合ICMP由上层实现可靠性&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;tcp协议:37348dd643956dbb1568c00c8cc0c5b2&#34;&gt;TCP协议&lt;/h2&gt;

&lt;p&gt;流量控制的思想可以用于上层应用的开发&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;附加TCP部首&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;可靠协议&lt;br /&gt;

&lt;ol&gt;
&lt;li&gt;合理分块&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;超时重发&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;校验和校验&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;发送确认&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;组装时排序&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;滑动窗口流控&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;建立连接，三次握手：&lt;br /&gt;

&lt;ol&gt;
&lt;li&gt;Client-&amp;gt;&amp;gt;Server: SYN&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Server&amp;ndash;&amp;gt;&amp;gt;Client: ACK&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Client&amp;ndash;&amp;gt;&amp;gt;Server: ACK&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;断开连接，四次握手：&lt;br /&gt;

&lt;ol&gt;
&lt;li&gt;Client-&amp;gt;&amp;gt;Server: FIN&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Server&amp;ndash;&amp;gt;&amp;gt;Client: ACK&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Server-&amp;gt;&amp;gt;Client: FIN&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Client&amp;ndash;&amp;gt;&amp;gt;Server: ACK&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;流量控制&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;延迟发送&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;捎带ACK：延迟发送ACK&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Nagle算法：延迟发送数据&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;滑动窗口 rwnd：接收方缓冲区&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;拥塞窗口 cwnd：探测带宽上限&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;慢启动阶段（未超过门限 ssthresh）&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cwnd *= 2&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;拥塞避免阶段（超过门限）&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cwnd += 1&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;超时重传&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;超时时间调整：简单的说，是一个涉及旧超时时间、新传输时间、经验系数、方差的函数&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;拥塞：某报文超时需要重传&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ssthresh /= 2&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cwnd = 1&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;进入慢启动阶段&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;快速重传：当收到3个重复ACK时（&lt;3个，乱序是大概率事件；&gt;=3个，丢包是大概率事件）&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ssthresh /= 2&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cwnd = ssthresh&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;进入拥塞避免阶段&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;快速恢复：（略）&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;其它计时器&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;坚持定时器：双方滑动窗口为0时的试探间隔，避免互相等待死锁&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;保活定时器：判断保持或断开半开放连接&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;2MSL定时器：端口可再次使用的计时器，在此期间，服务端可以重启而不报端口占用错误，但不可以建立连接&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>